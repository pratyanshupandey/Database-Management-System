LOAD EMPLOYEE
Q1TEMP1 <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM Q1TEMP1
CLEAR Q1TEMP1


ECE <- CROSS EMPLOYEE EMPLOYEE
EJE <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM ECE
SBDATE <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM EJE
Q2 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE2_Ssn, EMPLOYEE1_Bdate FROM SBDATE
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2
CLEAR ECE
CLEAR EJE
CLEAR SBDATE


LOAD WORKS_ON
WCE <- CROSS WORKS_ON EMPLOYEE
WJE <- SELECT Essn == Ssn FROM WCE
MPROJ <- SELECT Sex == 0 FROM WJE
FPROJ <- SELECT Sex == 1 FROM WJE
TPROJ <- CROSS MPROJ FPROJ
PROJ <- SELECT MPROJ_Pno == FPROJ_Pno FROM TPROJ
Q3 <- PROJECT MPROJ_Pno FROM PROJ
RENAME MPROJ_Pno TO Pno FROM Q3
CLEAR WCE
CLEAR WJE
CLEAR MPROJ
CLEAR FPROJ
CLEAR TPROJ
CLEAR PROJ


WCW <- CROSS WORKS_ON WORKS_ON
WJW <- SELECT WORKS_ON1_Pno == WORKS_ON2_Pno FROM WCW
ECWJW <- CROSS EMPLOYEE WJW
EJWJW <- SELECT Ssn == WORKS_ON1_Essn FROM ECWJW
EJWJWS <- SELECT Super_ssn == WORKS_ON2_Essn FROM EJWJW
Q4 <- PROJECT Ssn, Super_ssn, WORKS_ON1_Pno FROM EJWJWS
RENAME WORKS_ON1_Pno TO Pno FROM Q4
CLEAR WCW
CLEAR WJW
CLEAR ECWJW
CLEAR EJWJW
CLEAR EJWJWS

LOAD PROJECT
ND1 <- SELECT Dnum != 1 FROM PROJECT
ND1D5 <- SELECT Dnum != 5 FROM ND1
PCND1D5 <- CROSS PROJECT ND1D5
PROJS <- SELECT PROJECT_Dnum != ND1D5_Dnum FROM PCND1D5
Q5 <- PROJECT PROJECT_Pnumber, PROJECT_Dnum FROM PROJS
RENAME PROJECT_Pnumber TO Pnumber FROM Q5
RENAME PROJECT_Dnum TO Dnum FROM Q5
CLEAR ND1
CLEAR ND1D5
CLEAR PCND1D5
CLEAR PROJS

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5

QUIT